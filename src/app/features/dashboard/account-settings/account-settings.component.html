<div class="account-settings-container">
    <!-- Settings Header -->
    <div class="settings-header">
        <h2>{{ 'settings.title' | translate }}</h2>
        <p class="subtitle">{{ 'settings.subtitle' | translate }}</p>
    </div>

    <!-- Tabs Navigation -->
    <div class="settings-tabs">
        <button class="tab-btn" [class.active]="activeTab === 'update-profile'" (click)="switchTab('update-profile')">
            <i class="bi bi-person"></i> {{ 'settings.updateProfile' | translate }}
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'change-password'" (click)="switchTab('change-password')">
            <i class="bi bi-lock"></i> {{ 'settings.changePassword' | translate }}
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'reset-password'" (click)="switchTab('reset-password')">
            <i class="bi bi-arrow-repeat"></i> {{ 'settings.resetPassword' | translate }}
        </button>
        <button class="tab-btn danger" [class.active]="activeTab === 'delete-profile'"
            (click)="switchTab('delete-profile')">
            <i class="bi bi-trash"></i> {{ 'settings.deleteProfile' | translate }}
        </button>
    </div>

    <!-- Success/Error Messages -->
    <div *ngIf="successMessage" class="alert alert-success">
        {{ successMessage }}
    </div>
    <div *ngIf="errorMessage" class="alert alert-danger">
        {{ errorMessage }}
    </div>

    <!-- Tab Content -->
    <div class="tab-content">

        <!-- Update Profile Tab -->
        <div *ngIf="activeTab === 'update-profile'" class="tab-pane active">
            <form [formGroup]="updateProfileForm" (ngSubmit)="submitUpdateProfile()" class="settings-form">
                <div class="form-group">
                    <label for="fullName">{{ 'auth.register.fullName' | translate }} *</label>
                    <input type="text" id="fullName" class="form-control" formControlName="fullName"
                        [placeholder]="'settings.enterFullName' | translate"
                        [class.is-invalid]="updateProfileForm.get('fullName')?.invalid && updateProfileForm.get('fullName')?.touched">
                    <small class="error-text" *ngIf="updateProfileForm.get('fullName')?.errors?.['required']">
                        {{ 'settings.fullNameRequired' | translate }}
                    </small>
                    <small class="error-text" *ngIf="updateProfileForm.get('fullName')?.errors?.['minlength']">
                        {{ 'settings.fullNameMinLength' | translate }}
                    </small>
                </div>

                <div class="form-group">
                    <label for="userName">{{ 'auth.register.username' | translate }} *</label>
                    <input type="text" id="userName" class="form-control" formControlName="userName"
                        [placeholder]="'settings.enterUsername' | translate"
                        [class.is-invalid]="updateProfileForm.get('userName')?.invalid && updateProfileForm.get('userName')?.touched">
                    <small class="error-text" *ngIf="updateProfileForm.get('userName')?.errors?.['required']">
                        {{ 'settings.usernameRequired' | translate }}
                    </small>
                    <small class="error-text" *ngIf="updateProfileForm.get('userName')?.errors?.['minlength']">
                        {{ 'settings.usernameMinLength' | translate }}
                    </small>
                </div>

                <div class="form-group">
                    <label for="email">{{ 'auth.register.email' | translate }} *</label>
                    <input type="email" id="email" class="form-control" formControlName="email"
                        [placeholder]="'settings.enterEmail' | translate"
                        [class.is-invalid]="updateProfileForm.get('email')?.invalid && updateProfileForm.get('email')?.touched">
                    <small class="error-text" *ngIf="updateProfileForm.get('email')?.errors?.['required']">
                        {{ 'settings.emailRequired' | translate }}
                    </small>
                    <small class="error-text" *ngIf="updateProfileForm.get('email')?.errors?.['email']">
                        {{ 'auth.login.invalidEmail' | translate }}
                    </small>
                </div>

                <div class="form-group">
                    <label for="profilePhoto">{{ 'settings.profilePhoto' | translate }}</label>
                    <input type="file" id="profilePhoto" class="form-control" (change)="onFileSelected($event)"
                        accept="image/*">
                    <small class="text-muted">{{ 'settings.acceptedFormats' | translate }}</small>
                </div>

                <button type="submit" class="btn btn-primary" [disabled]="isLoading || updateProfileForm.invalid">
                    <span *ngIf="!isLoading">{{ 'settings.saveChanges' | translate }}</span>
                    <span *ngIf="isLoading">{{ 'common.saving' | translate }}</span>
                </button>
            </form>
        </div>

        <!-- Change Password Tab -->
        <div *ngIf="activeTab === 'change-password'" class="tab-pane active">
            <form [formGroup]="changePasswordForm" (ngSubmit)="submitChangePassword()" class="settings-form">
                <div class="form-group">
                    <label for="currentPassword">Current Password *</label>
                    <label for="currentPassword">{{ 'settings.currentPassword' | translate }} *</label>
                    <input type="password" id="currentPassword" class="form-control" formControlName="currentPassword"
                        [placeholder]="'settings.enterCurrentPassword' | translate"
                        [class.is-invalid]="changePasswordForm.get('currentPassword')?.invalid && changePasswordForm.get('currentPassword')?.touched">
                    <small class="error-text" *ngIf="changePasswordForm.get('currentPassword')?.errors?.['required']">
                        {{ 'settings.currentPasswordRequired' | translate }}
                    </small>
                </div>

                <div class="form-group">
                    <label for="newPassword">New Password *</label>
                    <label for="newPassword">{{ 'settings.newPassword' | translate }} *</label>
                    <input type="password" id="newPassword" class="form-control" formControlName="newPassword"
                        [placeholder]="'settings.enterNewPassword' | translate"
                        [class.is-invalid]="changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched">
                    <small class="error-text" *ngIf="changePasswordForm.get('newPassword')?.errors?.['required']">
                        {{ 'settings.newPasswordRequired' | translate }}
                    </small>
                    <small class="error-text" *ngIf="changePasswordForm.get('newPassword')?.errors?.['minlength']">
                        {{ 'settings.passwordMinLength' | translate }}
                    </small>
                    <small class="error-text" *ngIf="changePasswordForm.get('newPassword')?.errors?.['weakPassword']">
                        {{ 'settings.passwordStrengthRequirement' | translate }}
                    </small>
                </div>

                <div class="form-group">
                    <label for="confirmNewPassword">Confirm New Password *</label>
                    <label for="confirmNewPassword">{{ 'settings.confirmPassword' | translate }} *</label>
                    <input type="password" id="confirmNewPassword" class="form-control"
                        formControlName="confirmNewPassword"
                        [placeholder]="'settings.confirmPasswordPlaceholder' | translate"
                        [class.is-invalid]="changePasswordForm.get('confirmNewPassword')?.invalid && changePasswordForm.get('confirmNewPassword')?.touched">
                    <small class="error-text"
                        *ngIf="changePasswordForm.get('confirmNewPassword')?.errors?.['required']">
                        {{ 'settings.confirmPasswordRequired' | translate }}
                    </small>
                    <small class="error-text" *ngIf="changePasswordForm.errors?.['passwordMismatch']">
                        {{ 'settings.passwordMismatch' | translate }}
                    </small>
                </div>

                <button type="submit" class="btn btn-primary" [disabled]="isLoading || changePasswordForm.invalid">
                    <span *ngIf="!isLoading">üîí Change Password</span>
                    <span *ngIf="!isLoading">üîí {{ 'settings.changePasswordBtn' | translate }}</span>
                    <span *ngIf="isLoading">‚è≥ {{ 'settings.updating' | translate }}</span>
                </button>
            </form>
        </div>

        <!-- Reset Password Tab -->
        <div *ngIf="activeTab === 'reset-password'" class="tab-pane active">
            <form [formGroup]="resetPasswordForm" (ngSubmit)="submitResetPassword()" class="settings-form">
                <div class="form-info">
                    <p>Use this to reset your password with a reset token from your email.</p>
                    <p>{{ 'settings.resetFormInfo' | translate }}</p>
                </div>

                <div class="form-group">
                    <label for="resetEmail">Email *</label>
                    <label for="resetEmail">{{ 'settings.email' | translate }} *</label>
                    <input type="email" id="resetEmail" class="form-control" formControlName="email"
                        [placeholder]="'settings.enterEmail' | translate"
                        [class.is-invalid]="resetPasswordForm.get('email')?.invalid && resetPasswordForm.get('email')?.touched">
                    <small class="error-text" *ngIf="resetPasswordForm.get('email')?.errors?.['required']">
                        {{ 'settings.emailRequired' | translate }}
                    </small>
                    <small class="error-text" *ngIf="resetPasswordForm.get('email')?.errors?.['email']">
                        {{ 'settings.emailInvalid' | translate }}
                    </small>
                </div>

                <div class="form-group">
                    <label for="resetToken">Reset Token *</label>
                    <input type="text" id="resetToken" class="form-control" formControlName="token"
                        [placeholder]="'settings.resetTokenPlaceholder' | translate"
                        [class.is-invalid]="resetPasswordForm.get('token')?.invalid && resetPasswordForm.get('token')?.touched">
                    <small class="error-text" *ngIf="resetPasswordForm.get('token')?.errors?.['required']">
                        {{ 'settings.resetTokenRequired' | translate }}
                    </small>
                </div>

                <div class="form-group">
                    <label for="resetNewPassword">New Password *</label>
                    <input type="password" id="resetNewPassword" class="form-control" formControlName="newPassword"
                        [placeholder]="'settings.enterNewPassword' | translate"
                        [class.is-invalid]="resetPasswordForm.get('newPassword')?.invalid && resetPasswordForm.get('newPassword')?.touched">
                    <small class="error-text" *ngIf="resetPasswordForm.get('newPassword')?.errors?.['required']">
                        {{ 'settings.newPasswordRequired' | translate }}
                    </small>
                    <small class="error-text" *ngIf="resetPasswordForm.get('newPassword')?.errors?.['minlength']">
                        {{ 'settings.passwordMinLength' | translate }}
                    </small>
                    <small class="error-text" *ngIf="resetPasswordForm.get('newPassword')?.errors?.['weakPassword']">
                        {{ 'settings.passwordStrengthRequirement' | translate }}
                    </small>
                </div>

                <div class="form-group">
                    <label for="resetConfirmPassword">Confirm New Password *</label>
                    <input type="password" id="resetConfirmPassword" class="form-control"
                        formControlName="confirmNewPassword" [placeholder]="'settings.confirmPasswordPlaceholder' | translate"
                        [class.is-invalid]="resetPasswordForm.get('confirmNewPassword')?.invalid && resetPasswordForm.get('confirmNewPassword')?.touched">
                    <small class="error-text" *ngIf="resetPasswordForm.get('confirmNewPassword')?.errors?.['required']">
                        {{ 'settings.confirmPasswordRequired' | translate }}
                    </small>
                    <small class="error-text" *ngIf="resetPasswordForm.errors?.['passwordMismatch']">
                        {{ 'settings.passwordMismatch' | translate }}
                    </small>
                </div>

                <button type="submit" class="btn btn-primary" [disabled]="isLoading || resetPasswordForm.invalid">
                    <span *ngIf="!isLoading">üîÑ {{ 'settings.resetPasswordBtn' | translate }}</span>
                    <span *ngIf="isLoading">‚è≥ {{ 'settings.resetting' | translate }}</span>
                </button>
            </form>
        </div>

        <!-- Delete Profile Tab -->
        <div *ngIf="activeTab === 'delete-profile'" class="tab-pane active">
            <div class="delete-profile-section">
                <div class="delete-warning">
                    <h3>‚ö†Ô∏è {{ 'settings.deleteHeading' | translate }}</h3>
                    <p class="warning-text">
                        {{ 'settings.deleteWarningMsg' | translate }}
                    </p>
                </div>

                <div *ngIf="!showDeleteConfirmation" class="delete-action">
                    <p>{{ 'settings.deleteConfirmationMsg' | translate }}</p>
                    <button type="button" class="btn btn-danger" (click)="showDeleteConfirmation = true">
                        üóëÔ∏è {{ 'settings.deleteAccountBtn' | translate }}
                    </button>
                </div>

                <div *ngIf="showDeleteConfirmation" class="delete-confirmation">
                    <div class="confirmation-box">
                        <h4>üî¥ {{ 'settings.confirmDeletion' | translate }}</h4>
                        <p class="confirmation-text">
                            {{ 'settings.deletePermanentWarning' | translate }}
                        </p>
                        <div class="confirmation-actions">
                            <button type="button" class="btn btn-danger" [disabled]="isLoading"
                                (click)="submitDeleteProfile()">
                                <span *ngIf="!isLoading">{{ 'settings.yesPleaseDelete' | translate }}</span>
                                <span *ngIf="isLoading">‚è≥ {{ 'settings.deleting' | translate }}</span>
                            </button>
                            <button type="button" class="btn btn-secondary" [disabled]="isLoading"
                                (click)="cancelDelete()">
                                {{ 'common.cancel' | translate }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>